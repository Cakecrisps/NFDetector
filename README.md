# NetFreak Detector (NFDetect)

**NetFreak Detector** ‚Äî –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–µ—Ç–∏, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π –≤ –≤–∞—à–µ–π —Å–µ—Ç–∏: –Ω–µ–æ–±—ã—á–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π, –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —É–≥—Ä–æ–∑, –æ—Ç–∫–ª–æ–Ω—è—é—â–∏—Ö—Å—è –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã](#–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏-—Å–∏—Å—Ç–µ–º—ã)
2. [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
3. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
4. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
5. [–î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ](#–¥–µ—Ç–∞–ª—å–Ω–æ–µ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ)
   - [–†–µ–∂–∏–º Live-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞](#—Ä–µ–∂–∏–º-live-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)
   - [–†–µ–∂–∏–º –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–æ–≤](#—Ä–µ–∂–∏–º-–∞–Ω–∞–ª–∏–∑–∞-—Ñ–∞–π–ª–æ–≤)
6. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
   - [–§–∞–π–ª –ø—Ä–∞–≤–∏–ª (rules.json)](#—Ñ–∞–π–ª-–ø—Ä–∞–≤–∏–ª-rulesjson)
   - [–§–∞–π–ª –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö IP (protectips.txt)](#—Ñ–∞–π–ª-–∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö-ip-protectipstxt)
   - [–§–∞–π–ª –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP (suspips.txt)](#—Ñ–∞–π–ª-–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö-ip-suspipstxt)
7. [–°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–≥—Ä–æ–∑](#—Å–∏—Å—Ç–µ–º–∞-–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è-—É–≥—Ä–æ–∑)
8. [–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π](#—Å–∏—Å—Ç–µ–º–∞-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
9. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–≤—ã—Ö–æ–¥–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö)
10. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
11. [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)
12. [–õ–∏—Ü–µ–Ω–∑–∏—è](#–ª–∏—Ü–µ–Ω–∑–∏—è)

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

NFDetect ‚Äî —ç—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∞–Ω–æ–º–∞–ª–∏–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:

- **Live-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** —Å –æ—Ç–ª–∞–¥–∫–æ–π
- **–ê–Ω–∞–ª–∏–∑ PCAP-—Ñ–∞–π–ª–æ–≤** –¥–ª—è –æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞—Ç–∞–∫ –ø–µ—Ä–µ–±–æ—Ä–∞** (Brute Force) –ø–æ 5+ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º
- **–í—ã—è–≤–ª–µ–Ω–∏–µ DDoS –∞—Ç–∞–∫** (–æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö)
- **–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SYN/HTTP —Ñ–ª—É–¥–∞**
- **–ê–Ω–∞–ª–∏–∑ C2-—Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –±–∏–∫–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**
- **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** (–∫–æ–Ω—Å–æ–ª—å, –ª–æ–≥, –≤–Ω–µ—à–Ω–∏–µ –¥–æ–º–µ–Ω—ã)

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8 –∏–ª–∏ –≤—ã—à–µ
- –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è live-–∑–∞—Ö–≤–∞—Ç–∞
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install -r requirements.txt
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ requirements.txt
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞:

```bash
git clone <repository-url>
cd NetFreak-Detector
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install -r requirements.txt
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```bash
python nfddetect.py live -i eth0
```

### –ê–Ω–∞–ª–∏–∑ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

```bash
python nfddetect.py file -f capture.pcap
```

### –ü–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å –æ—Ç–ª–∞–¥–∫–æ–π

```bash
python nfddetect.py live -i eth0 -d --rules strict_rules.json --output daily_report
```

## –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

### –†–µ–∂–∏–º Live-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤

```bash
python nfddetect.py live
# –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∂–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
```

#### –ë–∞–∑–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
python nfddetect.py live -i eth0
```

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

```bash
python nfddetect.py live -i wlan0 \
  -d \
  --rules custom_rules.json \
  --protected_ips ext/my_trusted_ips.txt \
  --output /var/log/nfdetect \
  --log_file security_monitor_$(date +%Y%m%d).log
```

### –†–µ–∂–∏–º –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–æ–≤

#### –ê–Ω–∞–ª–∏–∑ –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

```bash
python nfddetect.py file -f /path/to/capture.pcap
```

#### –ü–∞–∫–µ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑

```bash
for pcap in captures/*.pcap; do
  python nfddetect.py file -f "$pcap" --output "analysis_$(basename "$pcap" .pcap)"
done
```

#### –ê–Ω–∞–ª–∏–∑ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏

```bash
python nfddetect.py file -f incident.pcap \
  --rules incident_rules.json \
  --protected_ips ext/corporate_ips.txt
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª –ø—Ä–∞–≤–∏–ª (rules.json)

```json
{
  "brute_force": {
    "enabled": true,
    "auth_proto": ["SMB", "SMB2", "SSH", "FTP", "TELNET"],
    "tryes_limit": 10.0,
    "tryes_limit_window": 20.0,
    "warn_tryes_limit_window": 100.0
  },
  "ddos": {
    "enabled": true,
    "1ip": {
      "request_limit": 1000.0,
      "request_limit_window": 1.0
    },
    "nip": {
      "request_limit": 2.0,
      "request_limit_window": 1.0,
      "display_ips": 10
    }
  },
  "flood": {
    "enabled": true,
    "SYN": {
      "syn_only_limit": 50.0,
      "syn_only_window": 5.0
    },
    "HTTP": {
      "request_rate_limit": 80.0,
      "request_rate_window": 1.0
    }
  },
  "C2_analysys": {
    "enabled": true,
    "beaconing_detection": {
      "enabled": true,
      "jitter_sec": 5,
      "interval_min_sec": 10,
      "interval_max_sec": 300,
      "min_consistent_connections": 5
    }
  },
  "reaction": {
    "out": ["PRINT", "LOG", "example.com", "alerts.mydomain.com"]
  },
  "suspicious_ips": {
    "enabled": true,
    "files_of_susp_ip_list": ["ext/suspips.txt"]
  }
}
```

### –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∞–≤–∏–ª

#### 1. **brute_force** - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞—Ç–∞–∫ –ø–µ—Ä–µ–±–æ—Ä–∞
- `enabled`: –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º–æ–¥—É–ª—å
- `auth_proto`: –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (SMB, SMB2, SSH, FTP, TELNET)
- `tryes_limit`: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `tryes_limit_window`: –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –ø–æ–ø—ã—Ç–æ–∫ (—Å–µ–∫—É–Ω–¥—ã)
- `warn_tryes_limit_window`: –û–∫–Ω–æ –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –æ –º–∞—Å—Å–æ–≤—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö

#### 2. **ddos** - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ DDoS –∞—Ç–∞–∫
- **1ip** (–æ–¥–∏–Ω–æ—á–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫):
  - `request_limit`: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
  - `request_limit_window`: –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ (—Å–µ–∫—É–Ω–¥—ã)
- **nip** (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –∞—Ç–∞–∫–∞):
  - `request_limit`: –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –æ–¥–Ω–æ–≥–æ IP
  - `request_limit_window`: –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ (—Å–µ–∫—É–Ω–¥—ã)
  - `display_ips`: –°–∫–æ–ª—å–∫–æ IP –ø–æ–∫–∞–∑–∞—Ç—å –≤ –æ—Ç—á–µ—Ç–µ

#### 3. **flood** - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ñ–ª—É–¥–∞
- **SYN flood**:
  - `syn_only_limit`: –õ–∏–º–∏—Ç SYN-–ø–∞–∫–µ—Ç–æ–≤ –±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤
  - `syn_only_window`: –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ (—Å–µ–∫—É–Ω–¥—ã)
- **HTTP flood**:
  - `request_rate_limit`: –õ–∏–º–∏—Ç HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤
  - `request_rate_window`: –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ (—Å–µ–∫—É–Ω–¥—ã)

#### 4. **C2_analysys** - –ê–Ω–∞–ª–∏–∑ C2-—Ç—Ä–∞—Ñ–∏–∫–∞
- `beaconing_detection`: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –±–∏–∫–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π)
  - `jitter_sec`: –î–æ–ø—É—Å—Ç–∏–º—ã–π —Ä–∞–∑–±—Ä–æ—Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (—Å–µ–∫—É–Ω–¥—ã)
  - `interval_min_sec`: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏
  - `interval_max_sec`: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏
  - `min_consistent_connections`: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

#### 5. **reaction** - –†–µ–∞–∫—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
- `out`: –°–ø–æ—Å–æ–±—ã –≤—ã–≤–æ–¥–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  - `PRINT` - –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å (—Ä–µ–∂–∏–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)
  - `LOG` - –∑–∞–ø–∏—Å—å –≤ –ª–æ–≥-—Ñ–∞–π–ª
  - `example.com` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞ –≤–Ω–µ—à–Ω–∏–π –¥–æ–º–µ–Ω (–≤–µ–±-—Ö—É–∫)

#### 6. **suspicious_ips** - –†–∞–±–æ—Ç–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP
- `enabled`: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP
- `files_of_susp_ip_list`: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å–æ —Å–ø–∏—Å–∫–æ–º IP

### –§–∞–π–ª –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö IP (protectips.txt)

```
# –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã
192.168.1.1      # –û—Å–Ω–æ–≤–Ω–æ–π —à–ª—é–∑
192.168.1.10     # DNS —Å–µ—Ä–≤–µ—Ä
#–£–∫–∞–∂–∏—Ç–µ —Ç–µ ip –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–∏–≤–∞—Ç—å—Å—è –ø—Ä–∏ ddos/brute/flodd etc...

```

### –§–∞–π–ª –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP (suspips.txt)

```
# –ò–∑–≤–µ—Å—Ç–Ω—ã–µ —Å–∫–∞–Ω–µ—Ä—ã Shodan
185.163.45.18
45.155.205.123
185.220.101.4

# –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ö–æ—Å—Ç—ã –∏–∑ —á–µ—Ä–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤
94.102.49.193
91.219.236.222
103.10.197.50

# –ë–æ—Ç–Ω–µ—Ç C&C —Å–µ—Ä–≤–µ—Ä—ã
198.51.100.23
203.0.113.45
```

## –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–≥—Ä–æ–∑

### 1. Brute Force Detection
- **–ü—Ä–æ—Ç–æ–∫–æ–ª—ã**: SMB, SMB2, SSH, FTP, TELNET
- **–¢—Ä–∏–≥–≥–µ—Ä**: >10 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 20 —Å–µ–∫—É–Ω–¥
- **–ú–∞—Å—Å–æ–≤–∞—è –∞—Ç–∞–∫–∞**: >100 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 100 —Å–µ–∫—É–Ω–¥

### 2. DDoS Protection
- **–û–¥–∏–Ω–æ—á–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫**: >1000 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –∞—Ç–∞–∫–∞**: >2 –∑–∞–ø—Ä–æ—Å–∞/—Å–µ–∫ —Å –∫–∞–∂–¥–æ–≥–æ IP
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: –¢–æ–ø-10 –∞—Ç–∞–∫—É—é—â–∏—Ö IP

### 3. Flood Prevention
- **SYN Flood**: >50 SYN –±–µ–∑ ACK –∑–∞ 5 —Å–µ–∫—É–Ω–¥
- **HTTP Flood**: >80 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫

### 4. C2 Beaconing Detection
- **–ò–Ω—Ç–µ—Ä–≤–∞–ª**: 10-300 —Å–µ–∫—É–Ω–¥ —Å –¥–∂–∏—Ç—Ç–µ—Ä–æ–º ¬±5—Å
- **–¢—Ä–∏–≥–≥–µ—Ä**: 5+ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

## –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –£—Ä–æ–≤–Ω–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

```json
"reaction": {
  "out": ["PRINT", "LOG", "alerts.corp.com", "slack-webhook.com"]
}
```

#### 1. **PRINT** - –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥
```
[WARNING] Brute Force detected from 192.168.1.50
Protocol: SSH, Attempts: 15, Window: 20s
```

#### 2. **LOG** - –§–∞–π–ª–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
cat out/log_2024-01-15_14-30-00.txt
```

#### 3. **–í–Ω–µ—à–Ω–∏–µ –¥–æ–º–µ–Ω—ã** - –í–µ–±-—Ö—É–∫–∏
- –û—Ç–ø—Ä–∞–≤–∫–∞ JSON —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ REST API endpoints
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SIEM —Å–∏—Å—Ç–µ–º–∞–º–∏

### –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

```json
"reaction": {
  "out": [
    "PRINT",
    "LOG",
    "alerts.corporation.com/api/v1/security",
    "123.com",
    "logserver.corp.com:514"
  ]
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```
NetFreak-Detector/
‚îú‚îÄ‚îÄ nfddetect.py          # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ rules.json           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª
‚îú‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ ext/                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ protectips.txt  # –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ IP
‚îÇ   ‚îî‚îÄ‚îÄ suspips.txt     # –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP
‚îú‚îÄ‚îÄ out/                # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
‚îÇ   ‚îú‚îÄ‚îÄ log_2024-01-15_14-30-00.txt # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É–≥—Ä–æ–∑—ã
‚îÇ   ‚îú‚îÄ‚îÄ log_2024-01-15_14-30-00_full_report.json     # –ü–æ–ª–Ω—ã–π json –æ—Ç—á–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ log_2024-01-15_14-30-00_summary.txt # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
‚îî‚îÄ‚îÄ general/           # –ú–æ–¥—É–ª–∏ —Å–∏—Å—Ç–µ–º—ã
    ‚îî‚îÄ‚îÄ uTrafficMonitor/
```

### –§–æ—Ä–º–∞—Ç –ª–æ–≥-—Ñ–∞–π–ª–∞

```
=== NFDetect Session Start ===
–í—Ä–µ–º—è: 2024-01-15 14:30:00
–†–µ–∂–∏–º: live
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: eth0
–û—Ç–ª–∞–¥–∫–∞: –í–∫–ª—é—á–µ–Ω–∞
–§–∞–π–ª: N/A
==============================

[14:30:05] INFO: –ù–∞—á–∞–ª–æ –∑–∞—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
[14:30:15] WARNING: Brute Force - 192.168.1.50 -> SSH (12 –ø–æ–ø—ã—Ç–æ–∫)
[14:30:20] ALERT: DDoS detected - 203.0.113.1 (1050 requests/sec)
[14:31:00] INFO: –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ alerts.corp.com
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å–µ—Ç–∏

```bash
sudo python nfddetect.py live -i enp3s0 \
  --rules corporate_rules.json \
  --protected_ips ext/corporate_ips.txt \
  --output /var/log/nfdetect/daily \
  --log_file $(date +%Y%m%d)_security.log
```

### –ü—Ä–∏–º–µ—Ä 2: –ê–Ω–∞–ª–∏–∑ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```bash
python nfddetect.py file -f incident_20240115.pcap \
  --rules forensic_rules.json \
  --protected_ips ext/trusted_assets.txt \
  --output incident_analysis \
  --log_file forensic_report.txt
```

### –ü—Ä–∏–º–µ—Ä 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SIEM —Å–∏—Å—Ç–µ–º–æ–π

```json
"reaction": {
  "out": [
    "PRINT",
    "LOG",
    "https://splunk.corp.com:8088/services/collector/event",
    "https://elastic.corp.com:9200/security-events/_doc"
  ]
}
```

```bash
python nfddetect.py live -i eth0 --rules siem_integration.json
```

### –ü—Ä–∏–º–µ—Ä 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–µ–±-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```json
{
  "ddos": {
    "enabled": true,
    "1ip": {
      "request_limit": 5000.0,
      "request_limit_window": 1.0
    }
  },
  "flood": {
    "enabled": true,
    "HTTP": {
      "request_rate_limit": 1000.0,
      "request_rate_window": 1.0
    }
  },
  "reaction": {
    "out": ["PRINT", "LOG", "webhooks.ops-team.com"]
  }
}
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞: "Permission denied"
```bash
sudo python nfddetect.py live -i eth0
```

### –û—à–∏–±–∫–∞: "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω"
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
touch ext/protectips.txt
touch ext/suspips.txt
cp rules.example.json rules.json
```

### –û—à–∏–±–∫–∞: "Interface not found"
```bash
# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
python nfddetect.py live
# –∏–ª–∏
ip link show
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

```json
"reaction": {
  "out": ["PRINT", "LOG"]  # –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ –≤–Ω–µ—à–Ω–∏–µ –¥–æ–º–µ–Ω—ã
}
```

### –û—Ç–ª–∞–¥–∫–∞ –º–æ–¥—É–ª–µ–π

```bash
python nfddetect.py live -i eth0 -d 2> debug.log
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

1. **–î–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π**:
```json
{
  "ddos": {
    "1ip": {
      "request_limit": 10000.0
    }
  },
  "flood": {
    "HTTP": {
      "request_rate_limit": 5000.0
    }
  }
}
```

2. **–î–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º**:
```json
{
  "brute_force": {
    "tryes_limit": 3.0,
    "tryes_limit_window": 10.0
  },
  "C2_analysys": {
    "beaconing_detection": {
      "jitter_sec": 2,
      "min_consistent_connections": 3
    }
  }
}
```

**–í–∞–∂–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ç—è—Ö, –≥–¥–µ —É –≤–∞—Å –µ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞—Ñ–∏–∫–∞. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ü–µ–ª–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∑–∞—â–∏—Ç—ã —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.